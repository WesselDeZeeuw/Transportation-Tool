%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Lachaise Assignment
% LaTeX Template
% Version 1.0 (26/6/2018)
%
% This template originates from:
% http://www.LaTeXTemplates.com
%
% Authors:
% Marion Lachaise & François Févotte
% Vel (vel@LaTeXTemplates.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{article}

\input{structure.tex} % Include the file specifying the document structure and custom commands

%----------------------------------------------------------------------------------------
%	ASSIGNMENT INFORMATION
%----------------------------------------------------------------------------------------

\title{Cost Comparison Tool Transportation Costs} % Title of the assignment

\author{W. de Zeeuw\\ \texttt{wessel.dezeeuw@tno.nl}} % Author name and email address

\date{TNO, Utrecht --- \today} % University, school and/or department name(s) and a date

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle % Print the title

%----------------------------------------------------------------------------------------
%	INTRODUCTION
%----------------------------------------------------------------------------------------

\section*{Introduction} % Unnumbered section

	This tool is developed for TNO. The main goal for this tool is to make a
    comparison of costs made in different electricity transportation scenarios.
    One of this scenarios consists of the costs made when captured wind energy
    is electrolized to H2, compressed and transported through a pipeline. A
    second scenarios is the direct transportation to the Dutch electricity net
    using electricity cables and either AD/DC currents.

\bigskip
\textit{Section in progress} 

\section{Installation}
In this section the installation process for the Cost Comparison Tool will be explained. After this section the reader will have a proper version of the tool available for his usage. 
\bigskip
\textit{Section in progress} 

\section{Main Application} % Numbered section

In this section the structure of the application will be explained in detail. The user can open the application in multiple ways, amongst which
\begin{enumerate}
	\item Using the Shortcut generated on the Desktop
	\item Using the Shortcut generated in the Start Menu
	\item Running the \texttt{.exe} file generated in the used specified installation folder
\end{enumerate}

After opening, the user will be presented the homescreen of the application. The home screen tool consists of different buttons and panels, as visualized in figure []. One can find the following buttons on the homescreen

\begin{enumerate}
	\item Import dataset: use this button to import all the required variables, factors and constants.  
	\item Change parameters: use this button to change the primary variables of the system. 
	\item Pipeline Transportation Cost Modules: use this window to select all different options for the compution pipeline transportation costs.
	\item Electric Energy Transportation Cost Modules: use this window to select all different options for the computation of electricity transportation costs.
	\item Compute Pipeline Costs: use this button to calculate, or update, the costs for pipeline transportation.
	\item Compute Electric Costs: use this button to calculate, or update, the costs for electric transportation.
\end{enumerate}

In the next sections, we will more thouroughly explain each of the requirements, functions and assumptions within each module. 

\subsection{Import dataset}
As mentioned before, this button will allows the user to import all required (default) values of the variables, factors and constants. The imported file must be of an \texttt{*.xlsx}-extention. The user is supplied with a default \texttt{*.xlsx} file that may be used. The lay-out of the input file is visualized in figure [].
\begin{warn}
	It must be noticed that none of the variables in the supplied dataset can be deleted. All inputs are used in the system, hence removing this data will lead to a system error. Next to this, the user is not allowed to change anything except for the values of the variables.
\end{warn}
 
 After a successful upload of the datafile, the user will be notified of this by a \texttt{'Upload successful!'} statement. Else, the user is supplied with a \texttt{'Upload not successful!'} statement. In this case the user should supply the tool with a different dataset.
 
 \begin{warn}
 	The user must upload a dataset in order for the tool to work!
 \end{warn}

After succesfull uploading of 

\subsection{Change Parameters}
By clicking on this button, the user is able to change any of the main variables of the program. The changable inputs are
\begin{enumerate}
	\item Project duration (years) 
	\item Pipeline length (km) 
	\item Design flow rate (Mt/a) 
	\item Minimum and Maximum Pressures (Pa) 
	\item Discount- and Utilization Rate 
	\item Pipeline configuration 
	\item Terrain settings
\end{enumerate}

The application will open a different window in which the paramters can be updated. The window representation is visualized in figure []. Each component of the screen shows the current value of the parameter. Each parameter may be adaptable within a certain range. You can change the values for the project duration, pipeline and design flow rate by sliding the corresponding slider into the required value. Turning the knob to the required value has the same effect for the Discount- and Utilization ratew. To enable different configurations, press the switch. This enables the user to input different steel compositions. The user may, if desired, change the number of crossings or terrain composition.
\begin{info}
	It may be, that the \texttt{Update} button is unavailable. If this is the case, then there is a fault in the user defined changes. Please make sure that the Pipeline configuration and Terrain settings add up to $100\%$ in total for each categories.
\end{info}
 After the user is happy with the changes made, the user must confirm the changes by pressing the \texttt{Update} button. After a successful parameter adaption the user can see the message \texttt{'Parameters updated successfully!'}. 
\begin{warn}
	Closing the screen by clicking the $(\times)$ will not save the changes.
\end{warn}

\subsection{Pipeline Transportation Cost Modules}
This window allows the user to define which cost modules the user wants to consider. By default, the \texttt{Consider Costs for new Pipeline} is selected. This option may be supplemented with different modules by holding down the \texttt{Ctrl}-button whilst clicking the required options. Any selected option can be disabled by clicking the required option once more, whilst pressing the \texttt{Ctrl}-button. 
\begin{warn}
At least one module must be selected. For now, not all modules are implemented and hence will return a $0$-cost constribution.  
\end{warn}
Each module calculates the costs corresponding to the selected option. We will discuss how the costs are calculated per module in section []. Here, the assumptions and sources can be found as well. 

\subsection{Electric Energy Costs Transportation Cost Modules}
This module is equal to the Pipeline Transportation Cost Module. Hence, this window allows the user to define which cost modules the user wants to consider. By default, the \texttt{Consider Costs for new Cable} is selected. This option may be supplemented with different modules by holding down the \texttt{Ctrl}-button whilst clicking the required options. Any selected option can be disabled by clicking the required option once more, whilst pressing the \texttt{Ctrl}-button. 
\begin{warn}
At least one module must be selected. For now, not all modules are implemented and hence will return a $0$-cost constribution.  
\end{warn}
Each module calculates the costs corresponding to the selected option. We will discuss how the costs are calculated per module in section []. Here, the assumptions and sources can be found as well.

\section{Pipeline Transportation Cost Modules: Assumptions and Model}
In this section we will describe the formulae and assumptions made to compute the costs. As the modules may be selected independently
\subsection{Consider Costs for new Cable}
To compute all the costs corresponding to having a new cable, we must first determine the properties of our pipeline. Amongst this, one finds parameter $D$, representing the diameter of the new pipeline in meters. This is modeled as a continous function depending on the flow. 
\begin{equation}
\label{eq:diameter}
D(f) = \frac{0.0077f^3 - 0.9856f^2 +49.0356f + 269.4506}{10^3} \text{[m] },
\end{equation}
where $f$ is the desired system flow in Megatonnes per year [Mt/a]. We may model the thickness of the wall ($w_t$) by
\begin{equation}
w_t(f) = \frac{0.003f^3 -0.0388f^2 +1.9299f + 10.6114}{10^3} \text{ [m]}, 
\end{equation}
\begin{info}
Both functions are obtained in \texttt{Matlab} by third-order interpolation of the data records from [source: pipeline4.xls]. This data represents a discrete function, but for simplicity in programming we assumed these functions to be continuous instead. 
\end{info}
The maximum allowed pressure in MPa is denoted as
\begin{equation}
P_{max} = 
\begin{cases} 
483 \text{MPa } \quad \text{ if steel composition only includes mild steel}\\
550 \text{MPa } \quad \text{ if steel composition includes stainless steel}
\end{cases}
\end{equation}
We call $SF$ the so-called Safety Factor, $P_{in}$ represents the design maximum input pressure. Then, the hoop stress ($\sigma_{\theta}$) in MPa, can be calculated according
\begin{equation}
\sigma_{\theta} = \frac{P_{in}D}{2w_t}  \text{ [MPa]}
\end{equation}
When $\sigma_{\theta} > \frac{P_{max}}{ SF}$, we conclude that the hoop stress is too high and may lead to dangerous situations.
\begin{info}
When the hoop stress in too high, this will lead to a warning message in the application. The user may decide wether or not to adjust the parameters to create a safe environment.
\end{info}
Next to the hoop stess, we also require the pressure drop to be sufficiently small. To do this, we first calculate the velocity of the flow  in meters per second by
\begin{equation}
v_{f} = \frac{4f_R}{\pi D^2} [m/s], 
\end{equation}
where $f_R$ is the flow rate in cubic meters per second. With this velocity we may calculate the Reynolds number $\mathtt{Re}$. This number allows us to formulate the friction constant $\nu$. This gives 
\begin{equation}
\mathtt{Re} = \frac{v_fL}{\mu} \Rightarrow \nu = \begin{cases} \frac{64}{\mathtt{Re}} &\quad \text{if } \mathtt{Re} <2300\\
\frac{0.3164}{\mathtt{Re}^{\frac{1}{4}}}&\quad  \text{ else}
\end{cases} 
\end{equation}
Finally, one can calculate the pressure drop $\Delta P$ in MPa as
\begin{equation}
\Delta P = L\nu \frac{\rho}{2}\frac{v_f^2}{D}\cdot 1\mathtt{e}-5 \quad\text{[MPa]}
\end{equation}

\end{document}